---
title: Планирование для Entity Framework Core 5.0
author: ajcvickers
ms.date: 01/14/2020
uid: core/what-is-new/ef-core-5.0/plan.md
ms.openlocfilehash: 0472841fdcd105ec8ea38db062c6768510b8735d
ms.sourcegitcommit: f2a38c086291699422d8b28a72d9611d1b24ad0d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/16/2020
ms.locfileid: "76125358"
---
# <a name="plan-for-entity-framework-core-50"></a>Планирование для Entity Framework Core 5.0

Как было описано в [процессе планирования](../release-planning.md), мы собрали сведения от заинтересованных лиц в предварительный план для выпуска EF Core 5.0.

> [!IMPORTANT] 
> Этот план отражает все еще продолжающиеся работы. Ничего из приведенного здесь не является обязательством. Этот план является отправной точкой и будет расширяться по мере обучения. Могут быть включены некоторые вещи, пока не запланированные для версии 5.0, и исключены некоторые вещи, уже запланированные для этой версии.

### <a name="version-number-and-release-date"></a>Номер версии и дата выпуска.

Сейчас выпуск EF Core 5.0 запланирован на [то же самое время, что и.NET 5.0](https://devblogs.microsoft.com/dotnet/introducing-net-5/). Версия "5.0" была выбрана для согласования с .NET 5.0.

### <a name="supported-platforms"></a>Поддерживаемые платформы

Планируется, что EF Core 5.0 можно будет запускать на любой платформе .NET 5.0 на основе [конвергенции этих платформ в .NET Core](https://devblogs.microsoft.com/dotnet/introducing-net-5/). Что это означает с точки зрения .NET Standard и фактически используемого TFM, еще предстоит установить.

EF Core 5.0 не будет работать в .NET Framework.

### <a name="breaking-changes"></a>Критические изменения

EF Core 5.0 будет содержать некоторые критические изменения, но они будут гораздо менее серьезными, чем в случае с EF Core 3.0. Наша цель состоит в том, чтобы позволить подавляющему большинству приложений осуществлять обновление без нарушения работы.

Ожидаются некоторые критические изменения для поставщиков баз данных, особенно связанные с поддержкой метода "одна таблица на тип". Однако мы ожидаем, что обновление поставщика для версии 5.0 потребует меньше работы, чем при обновлении для версии 3.0.

## <a name="themes"></a>Темы

Мы определили несколько основных областей или тем, которые сформируют основу для крупномасштабных инвестиций в EF Core 5.0.

## <a name="many-to-many-navigation-properties-aka-skip-navigations"></a>Свойства навигации "многие ко многим" (или "навигации с пропуском")

Ведущие разработчики: @smitpatel и @AndriySvyryd

Отслеживание с помощью [#19003](https://github.com/aspnet/EntityFrameworkCore/issues/19003)

Размер футболки: L

Состояние: ведутся работы

Функция "многие ко многим" является наиболее востребованной (около 407 голосов) в журнале невыполненной работы GitHub. Поддержку связей "многие ко многим" можно разбить на три основные области:

* Свойства навигации с пропуском. Они позволяют использовать модель для запросов и т. п. без ссылки на базовую сущность таблицы соединений.
* Типы сущностей контейнера свойств. Они позволяют использовать стандартный тип CLR (например, `Dictionary`) для экземпляров сущностей таким образом, чтобы для каждого типа сущности не требовался явный тип CLR.
* Средства для простоты настройки связей "многие ко многим".

Мы считаем, что наиболее существенным препятствием для тех, кому требуется поддержка типа "многие ко многим", заключается в невозможности использовать "естественные" связи, не ссылаясь на таблицу соединений, в бизнес-логике, такой как запросы. Тип сущности таблицы соединений может по-прежнему существовать, но не должен мешать бизнес-логике. Именно поэтому мы решили взяться за свойства навигации с пропуском для версии 5.0.

Сейчас другие части функции "многие ко многим" относятся к сверхплановой цели для EF Core 5.0. Это означает, что сейчас они отсутствуют в плане для версии 5.0, но, если все пойдет хорошо, мы надеемся включить их туда.

## <a name="table-per-type-tpt-inheritance-mapping"></a>Сопоставление наследования "одна таблица на тип"

Ведущий разработчик: @AndriySvyryd

Отслеживание с помощью [#2266](https://github.com/aspnet/EntityFrameworkCore/issues/2266)

Размер футболки: XL

Состояние: работа не начата

Мы работаем над методом "одна таблица на тип", так как это очень востребованная функция (около 254 голосов; третье место) и для нее требуются некоторые низкоуровневые изменения, которые, по нашему мнению, согласуются с основополагающим характером общего плана по .NET 5. Мы предполагаем, что это приведет к критическим изменениям для поставщиков баз данных, хотя они должны быть гораздо менее серьезными, чем для версии 3.0.

## <a name="filtered-include"></a>Включение с фильтрацией

Ведущий разработчик: @maumar

Отслеживание с помощью [#1833](https://github.com/aspnet/EntityFrameworkCore/issues/1833)

Размер футболки: M

Состояние: работа не начата

Включение с фильтрацией — это очень востребованная функция (около 317 голосов; второе место), которая потребует не слишком много работы и, по нашему мнению, позволит реализовать или упростить многие сценарии, в которых сейчас требуются фильтры уровня модели или более сложные запросы.

## <a name="rationalize-totable-toquery-toview-fromsql-etc"></a>Оптимизация ToTable, ToQuery, ToView, FromSql и т. п.

Ведущие разработчики: @maumar и @smitpatel

Отслеживание с помощью [#17270](https://github.com/aspnet/EntityFrameworkCore/issues/17270)

Размер футболки: L

Состояние: работа не начата

В предыдущих выпусках мы уже проделали определенную работу для поддержки необработанного SQL-кода, бесключевых типов и связанных с ними аспектов. Однако при попытке обеспечить работу этих функций как единого целого выявляются недочеты и несоответствия. Версия 5.0 должна устранить эти проблемы и обеспечить удобное определение, перенос и использование различных типов сущностей и связанных с ними запросов и артефактов баз данных. Это также может потребовать внесения изменений в скомпилированный API запросов.

Обратите внимание, что этот пункт может привести к некоторым критическим изменениям на уровне приложения, так как некоторые функциональные возможности, которыми мы сейчас располагаем, допускают слишком вольное обращение с ними, что может быстро привести к сбою. Скорее всего, мы заблокируем некоторые из этих функций и порекомендуем, чем их заменить.

## <a name="general-query-enhancements"></a>Общие усовершенствования запросов

Ведущие разработчики: @smitpatel и @maumar

Отслеживание с помощью [вопроса, отмеченного `area-query` в вехе 5.0](https://github.com/dotnet/efcore/issues?utf8=%E2%9C%93&q=is%3Aissue+label%3Aarea-query+milestone%3A5.0.0+)

Размер футболки: XL

Состояние: ведутся работы

Код преобразования запроса для EF Core 3.0 был в значительной степени переписан. Благодаря этому в общем случае код запроса находится в значительно более надежном состоянии. Для версии 5.0 мы не планируем вносить существенные изменения в запросы, за исключением тех, которые необходимы для поддержки метода "одна таблица на тип" и свойств навигации с пропуском. Однако по-прежнему требуется значительная работа, чтобы устранить технический долг, оставшийся после масштабного изменения версии 3.0. Мы также планируем исправить многие ошибки и внести небольшие улучшения для дальнейшего улучшения общего процесса работы с запросами.

## <a name="migrations-and-deployment-experience"></a>Процедура миграция и развертывания

Ведущие разработчики: @bricelam

Отслеживание с помощью [#19587](https://github.com/dotnet/efcore/issues/19587)

Размер футболки: L

Состояние: ведутся работы

Сейчас многие разработчики переносят свои базы данных во время запуска приложения. Это удобно, но не рекомендовано по следующим причинам:

* Несколько потоков/процессов/серверов могут одновременно попытаться перенести базу данных.
* При этом приложения могут попытаться перейти в несогласованное состояние.
* В общем случае разрешения базы данных на изменение схемы не должны предоставляться для выполнения приложения.
* Возврат к исходному состоянию в случае сбоя затруднен.

Мы хотим обеспечить улучшить эту процедуру, чтобы она позволяла легко перенести базу данных во время развертывания. Предъявляются следующие требования:

* Работа в Linux, Mac и Windows.
* Хорошая совместимость с командной строкой.
* Поддержка сценариев с контейнерами.
* Работа с средствами и потоками развертывания, часто применяемыми на практике.
* Интеграция по меньшей мере с Visual Studio.

Результат, скорее всего, будет представлять собой множество небольших улучшений в EF Core (например, улучшенная миграция в SQLite), а также руководства и долгосрочное сотрудничество с другими группами для улучшения комплексных возможностей, выходящих за пределы EF.

## <a name="ef-core-platforms-experience"></a>Возможности платформ EF Core 

Ведущие разработчики: @roji и @bricelam

Отслеживание с помощью [#19588](https://github.com/dotnet/efcore/issues/19588)

Размер футболки: L

Состояние: работа не начата

У нас есть хорошее руководство по использованию EF Core в традиционных веб-приложениях, работающих по принципу MVC. Рекомендации для других платформ и моделей приложений отсутствуют или устарели. Для EF Core 5.0 мы планируем изучить, улучшить и задокументировать процесс использования EF Core со следующими компонентами:

* Blazor
* Xamarin, в том числе использование AOT или компоновщика
* WinForms/WPF/WinUI и, возможно, другие платформы пользовательского интерфейса Инфраструктуры

Результат, скорее всего, будет представлять собой множество небольших улучшений в EF Core, а также руководства и долгосрочное сотрудничество с другими группами для улучшения комплексных возможностей, выходящих за пределы EF.

Ниже перечислены конкретные области, которые мы планируем рассмотреть:

* Развертывание, включая интерфейс для использования средств EF, таких как миграции
* Модели приложений, включая Xamarin и Blazor, и, возможно, другие
* Процедуры для SQLite, включая пространственное взаимодействие и перестроение таблиц
* Процедуры для AOT и компоновки
* Интеграция диагностики, включая счетчики производительности

## <a name="performance"></a>Производительность

Ведущий разработчик: @roji

Отслеживание с помощью [вопроса, отмеченного `area-perf` в вехе 5.0](https://github.com/dotnet/efcore/issues?utf8=%E2%9C%93&q=is%3Aissue+label%3Aarea-perf+milestone%3A5.0.0+)

Размер футболки: L

Состояние: ведутся работы

Для EF Core мы планируем улучшить набор тестов производительность и внести целевые улучшения производительности для среды выполнения. Кроме того, мы планируем завершить новый API пакетной обработки ADO.NET, который находился на этапе прототипа со времени цикла выпуска версии 3.0. Кроме того, на уровне ADO.NET мы планируем дополнительно улучшить производительность для поставщика Npgsql.

В рамках этой задачи мы также планируем добавить счетчики производительности ADO.NET/EF Core и другие средства диагностики.

## <a name="architecturalcontributor-documentation"></a>Документация по архитектуре и участникам

Ведущий документатор: @ajcvickers

Отслеживание с помощью [#1920](https://github.com/aspnet/EntityFramework.Docs/issues/1920)

Размер футболки: L

Состояние: работа не начата

Идея заключается в том, чтобы упростить понимание того, что происходит внутри EF Core. Это может быть полезно любому пользователю EF Core, однако основная мотивация заключается в том, чтобы упростить выполнение внешними пользователями следующих операций:

* Участие в разработке кода EF Core
* Создание поставщиков баз данных
* Создание других расширений

## <a name="microsoftdatasqlite-documentation"></a>Документация по Microsoft.Data.Sqlite

Ведущий документатор: @bricelam

Отслеживание с помощью [#1675](https://github.com/aspnet/EntityFramework.Docs/issues/1675)

Размер футболки: M

Состояние: работа завершена. Новая документация [доступна на веб-сайте документации Майкрософт](https://docs.microsoft.com/dotnet/standard/data/sqlite/?tabs=netcore-cli).

Группа EF также владеет поставщиком Microsoft.Data.Sqlite ADO.NET. Мы планируем полностью задокументировать этот поставщик в рамках выпуска 5.0.

## <a name="general-documentation"></a>Общая документация

Ведущий документатор: @ajcvickers

Отслеживание с помощью [вопросов в репозитории документации в вехе 5.0](https://github.com/aspnet/EntityFramework.Docs/issues?utf8=%E2%9C%93&q=is%3Aissue+milestone%3A5.0.0+)

Размер футболки: L

Состояние: ведутся работы

Мы уже приступили к обновлению документации для выпусков 3.0 и 3.1. Мы также работаем над следующими задачами:
  * Масштабная переработка документов по началу работы, чтобы сделать их более удобными и понятными
  * Реорганизация документов для облегчения поиска и добавления перекрестных ссылок
  * Добавление дополнительных сведений и уточнений в существующие документы
  * Обновление существующих и добавление новых примеров

## <a name="fixing-bugs"></a>Исправление ошибок

Отслеживание с помощью [вопроса, отмеченного `type-bug` в вехе 5.0](https://github.com/dotnet/efcore/issues?utf8=%E2%9C%93&q=is%3Aissue+milestone%3A5.0.0+label%3Atype-bug+)

Разработчики: @roji, @maumar, @bricelam, @smitpatel, @AndriySvyryd, @ajcvickers

Размер футболки: L

Состояние: ведутся работы

На момент написания статьи у нас отобрано 135 ошибок для исправления в выпуске 5.0 (62 уже исправлены), однако они во многом пересекаются с разделом _Общие усовершенствования запросов_ выше.

Скорость поступления (вопросы, превратившиеся в работу в вехе) в рамках выпуска 3.0 составила около 23 вопросов в месяц. Не все из них потребуется исправить в версии 5.0. Ориентировочно в рамках работы над версией 5.0 мы планируем устранить 150 дополнительных проблем.

## <a name="small-enhancements"></a>Небольшие усовершенствования

Отслеживание с помощью [вопроса, отмеченного `type-enhancement` в вехе 5.0](https://github.com/dotnet/efcore/issues?utf8=%E2%9C%93&q=is%3Aissue+milestone%3A5.0.0+label%3Atype-enhancement+)

Разработчики: @roji, @maumar, @bricelam, @smitpatel, @AndriySvyryd, @ajcvickers

Размер футболки: L

Состояние: ведутся работы

В дополнение к более масштабным функциям, описанным выше, у нас также есть множество небольших усовершенствований, запланированных для версии 5.0, которые призваны исправить мелкие недочеты. Обратите внимание, что многие из этих усовершенствований также входят в более общие темы, описанные выше.

## <a name="below-the-line"></a>Выход за пределы плана

Отслеживание с помощью [вопроса, отмеченного `consider-for-next-release`](https://github.com/aspnet/EntityFrameworkCore/issues?q=is%3Aopen+is%3Aissue+label%3Aconsider-for-next-release)

Это исправления ошибок и усовершенствования, которые пока **не** запланированы для выпуска 5.0, но мы постараемся включить их в зависимости от того, как будет продвигаться описанная выше работа.

Кроме того, при планировании мы всегда учитываем [вопросы, набравшие больше всего голосов](https://github.com/dotnet/efcore/issues?q=is%3Aissue+is%3Aopen+sort%3Areactions-%2B1-desc). Исключение любой из подобных проблем из выпуска всегда дается нелегко, но нам нужен реалистичный план с учетом ресурсов, которыми мы располагаем.

## <a name="feedback"></a>Отзывы

Нам важно ваше мнение о планировании. Лучший способ указать важность проблемы — проголосовать за нее на GitHub. Эти данные будут учитываться в [процессе планирования](../release-planning.md) для следующего выпуска.
