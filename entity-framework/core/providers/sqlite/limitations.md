---
title: Поставщик базы данных SQLite — ограничения — EF Core
description: Ограничения поставщика базы данных Entity Framework Core SQLite по сравнению с другими поставщиками
author: bricelam
ms.date: 09/24/2020
uid: core/providers/sqlite/limitations
ms.openlocfilehash: 3d696474d401e8fd6c26a78067d292f0bb97a457
ms.sourcegitcommit: 0a25c03fa65ae6e0e0e3f66bac48d59eceb96a5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/14/2020
ms.locfileid: "92062741"
---
# <a name="sqlite-ef-core-database-provider-limitations"></a>Ограничения поставщика базы данных SQLite EF Core

Поставщик SQLite имеет ряд ограничений на миграции. Большинство этих ограничений являются следствием ограничений в базовом ядре базы данных SQLite и не относятся к EF.

## <a name="modeling-limitations"></a>Ограничения моделирования

Общая реляционная библиотека (совместно используемая Entity Framework поставщиками реляционных баз данных) определяет интерфейсы API для концепций моделирования, общих для большинства ядер реляционных баз данных. Некоторые из этих концепций не поддерживаются поставщиком SQLite.

* Схемы
* Последовательности

## <a name="query-limitations"></a>Ограничения запросов

SQLite изначально не поддерживает следующие типы данных. EF Core может считывать и записывать значения этих типов, также поддерживается запрос на равенство ( `where e.Property == value` ). Однако для других операций, таких как сравнение и упорядочение, потребуется Оценка на клиенте.

* DateTimeOffset
* Decimal
* TimeSpan
* UInt64

Вместо рекомендуется `DateTimeOffset` использовать значения типа DateTime. При обработке нескольких часовых поясов рекомендуется преобразовать значения в формат UTC перед сохранением, а затем выполнить преобразование в соответствующий часовой пояс.

`Decimal`Тип обеспечивает высокий уровень точности. Однако если такой уровень точности не требуется, вместо него рекомендуется использовать Double. Можно использовать [преобразователь значений](xref:core/modeling/value-conversions) , чтобы продолжить использование десятичного разделителя в классах.

```csharp
modelBuilder.Entity<MyEntity>()
    .Property(e => e.DecimalProperty)
    .HasConversion<double>();
```

## <a name="migrations-limitations"></a>Ограничения миграции

Ядро базы данных SQLite не поддерживает ряд операций с схемами, которые поддерживаются большинством других реляционных баз данных. При попытке применить одну из неподдерживаемых операций к базе данных SQLite `NotSupportedException` будет выдано исключение.

Будет предпринята попытка перестроения для выполнения определенных операций. Перестроение возможно только для артефактов базы данных, которые являются частью модели EF Core. Если артефакт базы данных не является частью модели, например, если он был создан вручную внутри миграции, то создается `NotSupportedException` исключение.

| Операция            | Поддержка  | Требуется версия |
|:---------------------|:------------|:-----------------|
| аддчеккконстраинт   | ✔ (Перестроение) | 5.0              |
| AddColumn            | ✔           |                  |
| аддфореигнкэй        | ✔ (Перестроение) | 5.0              |
| аддпримарикэй        | ✔ (Перестроение) | 5.0              |
| аддуникуеконстраинт  | ✔ (Перестроение) | 5.0              |
| алтерколумн          | ✔ (Перестроение) | 5.0              |
| CreateIndex          | ✔           |                  |
| CreateTable          | ✔           |                  |
| дропчеккконстраинт  | ✔ (Перестроение) | 5.0              |
| DropColumn           | ✔ (Перестроение) | 5.0              |
| дропфореигнкэй       | ✔ (Перестроение) | 5.0              |
| DropIndex            | ✔           |                  |
| дроппримарикэй       | ✔ (Перестроение) | 5.0              |
| DropTable            | ✔           |                  |
| дропуникуеконстраинт | ✔ (Перестроение) | 5.0              |
| ренамеколумн         | ✔           | 2.2              |
| ренамеиндекс          | ✔ (Перестроение) |                  |
| ренаметабле          | ✔           |                  |
| енсуресчема         | ✔ (без op)   |                  |
| DropSchema           | ✔ (без op)   |                  |
| Вставить               | ✔           |                  |
| Update               | ✔           |                  |
| DELETE               | ✔           |                  |

### <a name="migrations-limitations-workaround"></a>Обходные ограничения для миграции

Некоторые из этих ограничений можно решить, вручную записав код в миграции для выполнения перестроения. Перестроение таблиц подразумевает создание новой таблицы, копирование данных в новую таблицу, удаление старой таблицы и переименование новой таблицы. `Sql(string)`Для выполнения некоторых из этих действий потребуется использовать метод.

Дополнительные сведения см. в разделе [внесение других изменений схемы таблицы](https://sqlite.org/lang_altertable.html#otheralter) в документацию по SQLite.

### <a name="idempotent-script-limitations"></a>Ограничения сценария идемпотентными

В отличие от других баз данных, SQLite не включает процедурный язык. Поэтому не существует способа создания логики if-then, необходимой для сценариев миграции идемпотентными.

Если вы знакомы с последней миграцией, примененной к базе данных, можно создать сценарий из этой миграции на последнюю миграцию.

```dotnetcli
dotnet ef migrations script CurrentMigration
```

В противном случае мы рекомендуем использовать `dotnet ef database update` для применения миграций. Начиная с EF Core 5,0, можно указать файл базы данных при выполнении команды.

```dotnetcli
dotnet ef database update --connection "Data Source=My.db"
```

## <a name="see-also"></a>См. также статью

* [Ограничения Async Microsoft. Data. SQLite](/dotnet/standard/data/sqlite/async)
* [Ограничения Microsoft. Data. SQLite ADO.NET](/dotnet/standard/data/sqlite/adonet-limitations)
