---
title: Поддержка перечисления — конструктор EF-EF6
description: Поддержка перечисления-конструктор EF в Entity Framework 6
author: ajcvickers
ms.date: 10/23/2016
uid: ef6/modeling/designer/data-types/enums
ms.openlocfilehash: 42508b533249bf01c76939f864a23adc86a08822
ms.sourcegitcommit: 0a25c03fa65ae6e0e0e3f66bac48d59eceb96a5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/14/2020
ms.locfileid: "92064930"
---
# <a name="enum-support---ef-designer"></a>Поддержка перечисления-конструктор EF
> [!NOTE]
> **Только EF5** — функции, API и т. д., обсуждаемые на этой странице, появились в Entity Framework 5. При использовании более ранней версии могут быть неприменимы некоторые или все сведения.

В этом видео и пошаговом руководстве показано, как использовать типы Enum с Entity Framework Designer. В нем также показано, как использовать перечисления в запросе LINQ.

В этом пошаговом руководстве будет использоваться Model First для создания новой базы данных, но конструктор EF также можно использовать с рабочим процессом [Database First](xref:ef6/modeling/designer/workflows/database-first) для соотнесения с существующей базой данных.

Поддержка перечисления появилась в Entity Framework 5. Чтобы использовать новые функции, такие как перечисления, пространственные типы данных и функции, возвращающие табличное значение, необходимо выбрать .NET Framework 4,5. Visual Studio 2012 нацелена на .NET 4,5 по умолчанию.

В Entity Framework перечисление может иметь следующие базовые типы: **Byte**, **Int16**, **Int32**, **Int64** или **SByte**.

## <a name="watch-the-video"></a>Просмотр видео
В этом видео показано, как использовать типы Enum с Entity Framework Designer. В нем также показано, как использовать перечисления в запросе LINQ.

**Представлено**: Julia Корнич

**Видео**: [WMV](https://download.microsoft.com/download/0/7/A/07ADECC9-7893-415D-9F20-8B97D46A37EC/HDI-ITPro-MSDN-winvideo-enumwithdesiger.wmv)  |  [MP4](https://download.microsoft.com/download/0/7/A/07ADECC9-7893-415D-9F20-8B97D46A37EC/HDI-ITPro-MSDN-mp4video-enumwithdesiger.m4v)  |  [WMV (ZIP)](https://download.microsoft.com/download/0/7/A/07ADECC9-7893-415D-9F20-8B97D46A37EC/HDI-ITPro-MSDN-winvideo-enumwithdesiger.zip)

## <a name="pre-requisites"></a>Предварительные требования

Для выполнения инструкций этого пошагового руководства необходимо установить Visual Studio 2012, Ultimate, Premium, Professional или Web Express Edition.

## <a name="set-up-the-project"></a>Настройка проекта

1.  Откройте Visual Studio 2012
2.  В меню **файл** наведите указатель мыши на пункт **создать**и выберите **проект** .
3.  В левой области щелкните **Visual C \# **, а затем выберите шаблон **консоли** .
4.  Введите **енумефдесигнер** в качестве имени проекта и нажмите кнопку **ОК** .

## <a name="create-a-new-model-using-the-ef-designer"></a>Создание новой модели с помощью конструктора EF

1.  Щелкните правой кнопкой мыши имя проекта в обозреватель решений, наведите указатель на пункт **Добавить**и выберите пункт **новый элемент** .
2.  Выберите **данные** в меню слева, а затем выберите **ADO.NET EDM** в области Шаблоны.
3.  Введите **енумтестмодел. EDMX** в поле имя файла и нажмите кнопку **Добавить** .
4.  На странице "Мастер EDM" в диалоговом окне Выбор содержимого модели выберите **Пустая модель** .
5.  Нажмите кнопку **Готово**.

Отобразится Entity Designer, предоставляющий область конструктора для редактирования модели.

Мастер выполняет следующие действия.

-   Создает файл Енумтестмодел. EDMX, который определяет концептуальную модель, модель хранения и сопоставление между ними. Задает свойство обработки артефакта метаданных файла EDMX, которое будет внедрено в выходную сборку, чтобы созданные файлы метаданных были внедрены в сборку.
-   Добавляет ссылку на следующие сборки: EntityFramework, System. ComponentModel. Аннотация и System. Data. Entity.
-   Создает файлы EnumTestModel.tt и EnumTestModel.Context.tt и добавляет их в EDMX файл. Эти файлы шаблонов T4 создают код, определяющий производный тип DbContext и типы POCO, которые сопоставляются с сущностями в модели EDMX.

## <a name="add-a-new-entity-type"></a>Добавить новый тип сущности

1.  Щелкните правой кнопкой мыши пустую область в области конструктора, выберите пункт **Добавить- &gt; сущность**, откроется диалоговое окно Новая сущность.
2.  Укажите **Отдел** для имени типа и укажите **DepartmentID** в качестве имени ключевого свойства, оставьте тип **Int32** .
3.  Нажмите кнопку **ОК**.
4.  Щелкните сущность правой кнопкой мыши и выберите пункт **Добавить новое — &gt; скалярное свойство** .
5.  Переименовать новое свойство в **имя**
6.  Измените тип нового свойства на **Int32** (по умолчанию новое свойство имеет значение типа String), чтобы изменить тип, откройте окно свойств и измените свойство Type на **Int32** .
7.  Добавьте еще одно скалярное свойство и переименуйте его в **бюджет**, измените тип на **Decimal** .

## <a name="add-an-enum-type"></a>Добавление типа перечисления

1.  В Entity Framework Designer щелкните правой кнопкой мыши свойство имя и выберите **преобразовать в перечисление** .

    ![Преобразовать в перечисление](~/ef6/media/converttoenum.png)

2.  В диалоговом окне **Добавление перечисления** введите **Департментнамес** в поле имя типа Enum, измените базовый тип на **Int32**, а затем добавьте следующие члены в тип: Английский, математика и экономические.

    ![Добавить тип перечисления](~/ef6/media/addenumtype.png)

3.  Нажмите кнопку **ОК**.
4.  Сохранение модели и сборка проекта
    > [!NOTE]
    > При сборке в Список ошибок могут отображаться предупреждения о несопоставленных сущностях и ассоциациях. Эти предупреждения можно игнорировать, так как после выбора создания базы данных из модели ошибки будут исчезнуть.

Если взглянуть на окно свойств, вы увидите, что тип свойства Name был изменен на **департментнамес** , а вновь добавленный тип перечисления был добавлен в список типов.

При переключении в окно обозревателя моделей вы увидите, что тип также был добавлен в узел Типы перечислений.

![Обозреватель моделей](~/ef6/media/modelbrowser.png)

>[!NOTE]
> Можно также добавить новые типы перечислений из этого окна, щелкнув правой кнопкой мыши и выбрав **Добавить тип перечисления**. После создания тип появится в списке типов, и вы сможете связать его со свойством.

## <a name="generate-database-from-model"></a>Создать базу данных из модели

Теперь можно создать базу данных, основанную на модели.

1.  Щелкните правой кнопкой мыши пустое пространство на поверхности Entity Designer и выберите пункт **создать базу данных из модели** .
2.  Откроется диалоговое окно Выбор подключения к данным мастера создания базы данных. Нажмите кнопку **создать подключение** , укажите **(LocalDB) \\ mssqllocaldb** для имени сервера и **енумтест** для базы данных и нажмите кнопку **ОК** .
3.  Появится диалоговое окно с вопросом о том, нужно ли создать новую базу данных, и нажать кнопку **Да**.
4.  Нажмите кнопку **Далее** , и мастер создания базы данных создаст язык описания данных (DDL) для создания базы данных. в диалоговом окне "Сводка и параметры" отображается созданная DDL-инструкция. Обратите внимание, что в DDL не содержится определение таблицы, сопоставленной с типом перечисления.
5.  Нажмите кнопку **Готово** , чтобы не выполнять скрипт DDL.
6.  Мастер создания базы данных выполняет следующие действия: открывает файл **енумтест. edmx. SQL** в редакторе T-SQL. создает схему хранилища и разделы СОПОСТАВЛЕНИЯ файла EDMX, добавляя сведения строки подключения к файлу App.config
7.  Щелкните правой кнопкой мыши в редакторе T-SQL и выберите пункт **выполнить** диалоговое окно соединение с сервером, введите сведения о подключении на шаге 2 и нажмите кнопку **подключить** .
8.  Чтобы просмотреть созданную схему, щелкните правой кнопкой мыши имя базы данных в обозреватель объектов SQL Server и выберите **Обновить** .

## <a name="persist-and-retrieve-data"></a>Сохранение и получение данных

Откройте файл Program.cs, в котором определен метод Main. Добавьте следующий код в функцию main. Код добавляет новый объект Department в контекст. Затем данные сохраняются. Код также выполняет запрос LINQ, возвращающий отдел, имя которого — Департментнамес. English.

``` csharp
using (var context = new EnumTestModelContainer())
{
    context.Departments.Add(new Department{ Name = DepartmentNames.English });

    context.SaveChanges();

    var department = (from d in context.Departments
                        where d.Name == DepartmentNames.English
                        select d).FirstOrDefault();

    Console.WriteLine(
        "DepartmentID: {0} and Name: {1}",
        department.DepartmentID,  
        department.Name);
}
```

Скомпилируйте и запустите приложение. Программа выдает следующие результаты.

```console
DepartmentID: 1 Name: English
```

Чтобы просмотреть данные в базе данных, щелкните правой кнопкой мыши имя базы данных в обозреватель объектов SQL Server и выберите **Обновить**. Затем щелкните правой кнопкой мыши таблицу и выберите **Просмотр данных**.

## <a name="summary"></a>Итоги

В этом пошаговом руководстве мы рассмотрели, как сопоставлять перечисляемые типы с помощью Entity Framework Designer и как использовать перечисления в коде. 
