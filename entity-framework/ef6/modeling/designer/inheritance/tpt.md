---
title: Наследование TPT в конструкторе — EF6
description: Наследование TPT в конструкторе в Entity Framework 6
author: divega
ms.date: 10/23/2016
ms.assetid: efc78c31-b4ea-4ea3-a0cd-c69eb507020e
uid: ef6/modeling/designer/inheritance/tpt
ms.openlocfilehash: cb686a9f51b14651c210102845de495906318747
ms.sourcegitcommit: 7c3939504bb9da3f46bea3443638b808c04227c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2020
ms.locfileid: "89620473"
---
# <a name="designer-tpt-inheritance"></a>Наследование TPT конструктора
В этом пошаговом руководстве показано, как реализовать наследование типа "таблица на тип" (TPT) в модели с помощью Entity Framework Designer (конструктор EF). В наследовании типа «одна таблица на тип» используется отдельная таблица в базе данных для сопровождения данных, относящихся к ненаследуемым свойствам и ключевым свойствам для каждого типа в иерархии наследования.

В этом пошаговом руководстве мы **Сообразим курс** (базовый тип), **онлинекаурсе** (наследуется от курса) и сущности **OnsiteCourse**   (наследуется от **курса**) к таблицам с теми же именами. Мы создадим модель из базы данных, а затем изменим модель, чтобы реализовать наследование TPT.

Можно также начать с Model First, а затем создать базу данных на основе модели. По умолчанию конструктор EF использует стратегию TPT, поэтому все наследования в модели будут сопоставляться с отдельными таблицами.

## <a name="other-inheritance-options"></a>Другие параметры наследования

«Одна таблица на иерархию» — это еще один тип наследования, в котором одна таблица базы данных используется для хранения данных всех типов сущностей в иерархии наследования.Сведения о сопоставлении наследования "одна таблица на иерархию" с Entity Designer см. в разделе [наследование в конструкторе EF](xref:ef6/modeling/designer/inheritance/tph). 

Обратите внимание, что модель наследования типа "Таблица — конкретная" и смешанное наследование поддерживаются средой выполнения Entity Framework, но не поддерживаются конструктором EF. Если вы хотите использовать функции TPC или смешанное наследование, у вас есть два варианта: использовать Code First или вручную изменить файл EDMX. Если вы решили работать с файлом EDMX, окно сведения о сопоставлении будет переведено в "защищенный режим", и вы не сможете использовать конструктор для изменения сопоставлений.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения данного пошагового руководства требуется:

- Последняя версия Visual Studio.
- [Образец базы данных School](xref:ef6/resources/school-database).

## <a name="set-up-the-project"></a>Настройка проекта

-   Откройте Visual Studio 2012.
-   Выбор **файла- &gt; создать- &gt; проект**
-   В левой области щелкните **Visual C \# **, а затем выберите шаблон **консоли** .
-   Введите **тптдбфирстсампле**в   качестве имени.
-   Выберите **OK**.

## <a name="create-a-model"></a>Создание модели

-   Щелкните правой кнопкой мыши проект в обозреватель решений и выберите **Добавить- &gt; новый элемент**.
-   Выберите **данные** в меню слева, а затем выберите **ADO.NET EDM** в области Шаблоны.
-   Введите **тптмодел. EDMX** в поле имя файла и нажмите кнопку **Добавить**.
-   В диалоговом окне Выбор содержимого модели выберите пункт**   создать из базы данных**, а затем нажмите кнопку **Далее**.
-   Нажмите кнопку **создать соединение**.
    В диалоговом окне Свойства соединения введите имя сервера (например, **(LocalDB) \\ mssqllocaldb**), выберите метод проверки подлинности, введите **School**   в качестве имени базы данных и нажмите кнопку **ОК**.
    В диалоговом окне Выбор подключения к данным будет обновлен параметр подключения к базе данных.
-   В диалоговом окне Выбор объектов базы данных в узле таблицы выберите таблицы **Отдел**, **курс, онлинекаурсе и OnsiteCourse** .
-   Нажмите кнопку **Готово**.

Отобразится Entity Designer, предоставляющий область конструктора для редактирования модели. Все объекты, выбранные в диалоговом окне Выбор объектов базы данных, добавляются в модель.

## <a name="implement-table-per-type-inheritance"></a>Реализация наследования типа «таблица на тип»

-   В области конструктора щелкните правой кнопкой мыши тип сущности **онлинекаурсе** и выберите пункт **свойства**.
-   В окне " **Свойства** " задайте для свойства "базовый тип" значение " **курс**".
-   Щелкните правой кнопкой мыши тип сущности **OnsiteCourse** и выберите пункт **свойства**.
-   В окне " **Свойства** " задайте для свойства "базовый тип" значение " **курс**".
-   Щелкните правой кнопкой мыши ассоциацию (линию) между типами сущностей **онлинекаурсе** и **Course** .
    Выберите **удалить из модели**.
-   Щелкните правой кнопкой мыши ассоциацию между типами сущностей **OnsiteCourse** и **Course** .
    Выберите **удалить из модели**.

Теперь мы удалим свойство **CourseID** из **онлинекаурсе** и **OnsiteCourse** , так как эти классы наследуют **CourseID** от базового типа **курса** .

-   Щелкните правой кнопкой мыши свойство **CourseID** типа сущности **онлинекаурсе** и выберите пункт **удалить из модели**.
-   Щелкните правой кнопкой мыши свойство **CourseID** типа сущности **OnsiteCourse** и выберите пункт **удалить из модели** .
-   Теперь наследование типа «одна таблица на тип» реализовано.

![Таблица на тип](~/ef6/media/tpt.png)

## <a name="use-the-model"></a>Использование модели

Откройте файл **Program.CS** , в котором определен метод **Main** . Вставьте следующий код в функцию **Main** . Код выполняет три запроса. Первый запрос возвращает все **курсы** , связанные с указанным подразделением. Второй запрос использует метод **OFTYPE** для возврата **онлинекаурсес** , связанного с указанным подразделением. Третий запрос возвращает **онситекаурсес**.

``` csharp
    using (var context = new SchoolEntities())
    {
        foreach (var department in context.Departments)
        {
            Console.WriteLine("The {0} department has the following courses:",
                               department.Name);

            Console.WriteLine("   All courses");
            foreach (var course in department.Courses )
            {
                Console.WriteLine("     {0}", course.Title);
            }

            foreach (var course in department.Courses.
                OfType<OnlineCourse>())
            {
                Console.WriteLine("   Online - {0}", course.Title);
            }

            foreach (var course in department.Courses.
                OfType<OnsiteCourse>())
            {
                Console.WriteLine("   Onsite - {0}", course.Title);
            }
        }
    }
```
