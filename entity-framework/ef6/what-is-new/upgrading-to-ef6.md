---
title: Обновление до Entity Framework 6 — EF6
description: Обновление до Entity Framework 6
author: divega
ms.date: 10/23/2016
ms.assetid: 29958ae5-85d3-4585-9ba6-550b8ec9393a
uid: ef6/what-is-new/upgrading-to-ef6
ms.openlocfilehash: b27504e3b18c668a1c41142b9cd5e697944cb5fa
ms.sourcegitcommit: 7c3939504bb9da3f46bea3443638b808c04227c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2020
ms.locfileid: "89619710"
---
# <a name="upgrading-to-entity-framework-6"></a>Обновление до Entity Framework 6

В предыдущих версиях EF код был разделен между основными библиотеками (в основном System.Data.Entity.dll), поставляемыми в составе .NET Framework и нестандартных (OOB) библиотек (в основном EntityFramework.dll), поставляемых в пакет NuGet. EF6 берет код из основных библиотек и внедряет его в библиотеки OOB. Это требовалось для того, чтобы платформа EF стала открытым исходным кодом и может развиваться в другом темпе от .NET Framework. Следствием этого является то, что приложения потребуется перестраивать для перемещенных типов.

Это должно быть простым для приложений, которые используют DbContext как поставляемые в EF 4,1 и более поздних версиях. Для приложений, использующих контекст ObjectContext, требуется немного больше работы, но это не так уж сложно.

Ниже приведен контрольный список действий, которые необходимо выполнить для обновления существующего приложения до EF6.

## <a name="1-install-the-ef6-nuget-package"></a>1. Установка пакета NuGet EF6

Необходимо выполнить обновление до новой среды выполнения Entity Framework 6.

1. Щелкните проект правой кнопкой мыши и выберите пункт **Управление пакетами NuGet...**  
2. На вкладке "в **сети** " выберите **EntityFramework** и нажмите кнопку " **установить** ".  
   > [!NOTE]
   > Если была установлена предыдущая версия пакета NuGet EntityFramework, обновит ее до EF6.

Кроме того, можно выполнить следующую команду из консоли диспетчера пакетов:

``` powershell
Install-Package EntityFramework
```

## <a name="2-ensure-that-assembly-references-to-systemdataentitydll-are-removed"></a>2. Убедитесь, что удалены ссылки на System.Data.Entity.dll сборки

Установка пакета NuGet EF6 должна автоматически удалить все ссылки на System. Data. Entity из вашего проекта.

## <a name="3-swap-any-ef-designer-edmx-models-to-use-ef-6x-code-generation"></a>3. переключайте любые модели конструктора EF (EDMX) для использования создания кода EF 6. x

При наличии моделей, созданных с помощью конструктора EF, необходимо обновить шаблоны создания кода, чтобы создать совместимый с EF6 код.

> [!NOTE]
> В настоящее время в Visual Studio 2012 и 2013 доступны только шаблоны генераторов EF 6. x DbContext.

1. Удаление существующих шаблонов создания кода. Обычно эти файлы имеют имя ** \<edmx_file_name\> . TT** и ** \<edmx_file_name\> . Context.tt** и будьте вложены в файл EDMX в Обозреватель решений. Можно выбрать шаблоны в обозреватель решений и нажать клавишу **Del** , чтобы удалить их.  
   > [!NOTE]
   > В проектах веб-сайтов шаблоны не будут вложены в файл EDMX, но перечислены вместе с ним в обозреватель решений.  

   > [!NOTE]
   > В проектах VB.NET необходимо включить параметр "Показать все файлы", чтобы иметь возможность просматривать файлы вложенных шаблонов.
2. Добавьте соответствующий шаблон создания кода EF 6. x. Откройте модель в конструкторе EF, щелкните правой кнопкой мыши область конструктора и выберите пункт **Добавить элемент создания кода...**
    - Если вы используете API DbContext (рекомендуется), то на вкладке " **данные** " будет доступен **генератор DbContext EF 6. x** .  
      > [!NOTE]
      > При использовании Visual Studio 2012 необходимо установить инструменты EF 6 для этого шаблона. Дополнительные сведения см. в разделе [получение Entity Framework](xref:ef6/fundamentals/install) .  

    - Если вы используете интерфейс ObjectContext API, необходимо выбрать вкладку "в **сети** " и найти **генератор EntityObject EF 6. x**.  
3. Если вы применили какие-либо настройки к шаблонам создания кода, потребуется повторно применить их к обновленным шаблонам.

## <a name="4-update-namespaces-for-any-core-ef-types-being-used"></a>4. Обновите пространства имен для всех используемых основных типов EF.

Пространства имен для типов DbContext и Code First не изменились. Это означает, что для многих приложений, использующих EF 4,1 или более поздней версии, не нужно ничего менять.

Такие типы, как ObjectContext, ранее находились в System.Data.Entity.dll, были перемещены в новые пространства имен. Это означает, что может потребоваться обновить директивы *using* или *Import* для создания EF6.

Общее правило изменения пространства имен заключается в том, что любой тип в System. Data. * перемещается в System. Data. Entity. Core. *. Иными словами, просто вставьте **Entity. Core.** После System. Data. Пример:

- System. Data. Ентитексцептион => System. Data. **Entity. Core**. ентитексцептион  
- System. Data. objects. ObjectContext => System. Data. **Entity. Core**. Objects. ObjectContext  
- Класс System. Data. objects. RelationshipManager => System. Data. **Entity. Core**. Objects. coclass. RelationshipManager  

Эти типы находятся в *основных* пространствах имен, так как они не используются напрямую для большинства приложений на основе DbContext. Некоторые типы, которые были частью System.Data.Entity.dll, по-прежнему используются как обычно, так и напрямую для приложений на основе DbContext и поэтому не были перемещены в *основные* пространства имен. А именно:

- System. Data. EntityState => System. Data. **Сущность**. EntityState  
- Класс System. Data. objects. Едмфунктионаттрибуте => System. Data. **Entity. дбфунктионаттрибуте**  
  > [!NOTE]
  > Этот класс был переименован; класс с прежним именем по-прежнему существует и работает, но теперь помечен как устаревший.  
- System. Data. objects. Ентитифунктионс => System. Data. **Entity. дбфунктионс**  
  > [!NOTE]
  > Этот класс был переименован; класс с прежним именем по-прежнему существует и работает, но теперь помечен как устаревший.)  
- Пространственные классы (например, заданное DbGeography, заданное DbGeometry) были перемещены из System. Data. пространственные => System. Data. **Сущность**. Привод

> [!NOTE]
> Некоторые типы в пространстве имен System. Data находятся в System.Data.dll, который не является сборкой EF. Эти типы не были перемещены, поэтому их пространства имен остаются неизменными.
