---
title: Работа с отключенными сущностями — EF6
description: Работа с отключенными сущностями в Entity Framework 6
author: divega
ms.date: 10/23/2016
ms.assetid: 12138003-a373-4817-b1b7-724130202f5f
uid: ef6/fundamentals/disconnected-entities/index
ms.openlocfilehash: 5465ba3c800e4f55d1f787cc3d3e22b55e9a68b0
ms.sourcegitcommit: 7c3939504bb9da3f46bea3443638b808c04227c2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/09/2020
ms.locfileid: "89616118"
---
# <a name="working-with-disconnected-entities"></a><span data-ttu-id="92ee6-103">Работа с отключенными сущностями</span><span class="sxs-lookup"><span data-stu-id="92ee6-103">Working with disconnected entities</span></span>

<span data-ttu-id="92ee6-104">В приложении на основе Entity Framework класс контекста несет ответственность за обнаружение изменений, применяемых к отслеживаемым сущностям.</span><span class="sxs-lookup"><span data-stu-id="92ee6-104">In an Entity Framework-based application, a context class is responsible for detecting changes applied to tracked entities.</span></span> <span data-ttu-id="92ee6-105">Вызов метода SaveChanges сохраняет изменения, отслеживаемые по контексту, в базу данных.</span><span class="sxs-lookup"><span data-stu-id="92ee6-105">Calling the SaveChanges method persists the changes tracked by the context to the database.</span></span> <span data-ttu-id="92ee6-106">При работе с n-уровневыми приложениями объекты сущностей, как правило, изменяются при отключении от контекста, и необходимо решить, как отслеживать изменения и передавать эти изменения обратно в контекст.</span><span class="sxs-lookup"><span data-stu-id="92ee6-106">When working with n-tier applications, entity objects are usually modified while disconnected from the context, and you must decide how to track changes and report those changes back to the context.</span></span> <span data-ttu-id="92ee6-107">В этом разделе рассматриваются различные параметры, доступные при использовании Entity Framework с отключенными сущностями.</span><span class="sxs-lookup"><span data-stu-id="92ee6-107">This topic discusses different options that are available when using Entity Framework with disconnected entities.</span></span>

## <a name="web-service-frameworks"></a><span data-ttu-id="92ee6-108">Платформы веб-службы</span><span class="sxs-lookup"><span data-stu-id="92ee6-108">Web service frameworks</span></span>

<span data-ttu-id="92ee6-109">Как правило, технологии веб-служб поддерживают шаблоны, которые могут использоваться для сохранения изменений в отдельных отключенных объектах.</span><span class="sxs-lookup"><span data-stu-id="92ee6-109">Web services technologies typically support patterns that can be used to persist changes on individual disconnected objects.</span></span> <span data-ttu-id="92ee6-110">Например, веб-API ASP.NET позволяет написать код для действий контроллера, которые могут включать вызовы к EF для сохранения изменений, внесенных в объект в базе данных.</span><span class="sxs-lookup"><span data-stu-id="92ee6-110">For example, ASP.NET Web API allows you to code controller actions that can include calls to EF to persist changes made to an object on a database.</span></span> <span data-ttu-id="92ee6-111">По сути, средства веб-API в Visual Studio упрощают автоматическую генерацию контроллера веб-API из модели Entity Framework 6.</span><span class="sxs-lookup"><span data-stu-id="92ee6-111">In fact, the Web API tooling in Visual Studio makes it easy to scaffold a Web API controller from your Entity Framework 6 model.</span></span> <span data-ttu-id="92ee6-112">Дополнительные сведения см. в разделе [Использование веб-API с Entity Framework 6](/aspnet/web-api/overview/data/using-web-api-with-entity-framework/).</span><span class="sxs-lookup"><span data-stu-id="92ee6-112">For more information, see [using Web API with Entity Framework 6](/aspnet/web-api/overview/data/using-web-api-with-entity-framework/).</span></span>

<span data-ttu-id="92ee6-113">Существовали и другие технологии веб-служб, которые обеспечивали интеграцию с Entity Framework, например [WCF Data Services](/dotnet/framework/data/wcf/create-a-data-service-using-an-adonet-ef-data-wcf) и [RIA Services](/previous-versions/dotnet/wcf-ria/ee707344(v=vs.91)).</span><span class="sxs-lookup"><span data-stu-id="92ee6-113">Historically, there have been several other Web services technologies that offered integration with Entity Framework, like [WCF Data Services](/dotnet/framework/data/wcf/create-a-data-service-using-an-adonet-ef-data-wcf) and [RIA Services](/previous-versions/dotnet/wcf-ria/ee707344(v=vs.91)).</span></span>

## <a name="low-level-ef-apis"></a><span data-ttu-id="92ee6-114">Низкоуровневые интерфейсы API EF</span><span class="sxs-lookup"><span data-stu-id="92ee6-114">Low-level EF APIs</span></span>

<span data-ttu-id="92ee6-115">Если вы не хотите использовать имеющееся n-уровневое решение или хотите настроить, что происходит внутри действия контроллера в службах веб-API, платформа Entity Framework предоставляет интерфейсы API, в которых можно вносить изменения на отключенном уровне.</span><span class="sxs-lookup"><span data-stu-id="92ee6-115">If you don't want to use an existing n-tier solution, or if you want to customize what happens inside a controller action in a Web API services, Entity Framework provides APIs that allow you to apply changes made on a disconnected tier.</span></span> <span data-ttu-id="92ee6-116">Дополнительные сведения см. в разделе [Добавление, вложение и состояние сущности](xref:ef6/saving/change-tracking/entity-state).</span><span class="sxs-lookup"><span data-stu-id="92ee6-116">For more information, see [Add, Attach, and entity state](xref:ef6/saving/change-tracking/entity-state).</span></span>  

## <a name="self-tracking-entities"></a><span data-ttu-id="92ee6-117">Сущности с самостоятельным отслеживанием</span><span class="sxs-lookup"><span data-stu-id="92ee6-117">Self-Tracking Entities</span></span>  

<span data-ttu-id="92ee6-118">Отслеживать изменения на произвольных графах сущностей при отсутствии подключения к контексту EF — это задача непростая.</span><span class="sxs-lookup"><span data-stu-id="92ee6-118">Tracking changes on arbitrary graphs of entities while disconnected from the EF context is a hard problem.</span></span> <span data-ttu-id="92ee6-119">Одной из попыток решить ее был шаблон генерации кода сущностей с самостоятельным отслеживанием.</span><span class="sxs-lookup"><span data-stu-id="92ee6-119">One of the attempts to solve it was the Self-Tracking Entities code generation template.</span></span> <span data-ttu-id="92ee6-120">Этот шаблон создает классы сущностей, которые содержат логику для отслеживания изменений на отключенном уровне как состояния самих сущностей.</span><span class="sxs-lookup"><span data-stu-id="92ee6-120">This template generates entity classes that contain logic to track changes made on a disconnected tier as state in the entities themselves.</span></span> <span data-ttu-id="92ee6-121">Также создается набор методов расширения для применения этих изменений к контексту.</span><span class="sxs-lookup"><span data-stu-id="92ee6-121">A set of extension methods is also generated to apply those changes to a context.</span></span>

<span data-ttu-id="92ee6-122">Этот шаблон можно использовать с моделями, созданными с помощью конструктора EF, но не с моделями Code First.</span><span class="sxs-lookup"><span data-stu-id="92ee6-122">This template can be used with models created using the EF Designer, but can not be used with Code First models.</span></span> <span data-ttu-id="92ee6-123">Дополнительные сведения см. в разделе [Сущности с самостоятельным отслеживанием](xref:ef6/fundamentals/disconnected-entities/self-tracking-entities/index).</span><span class="sxs-lookup"><span data-stu-id="92ee6-123">For more information, see [Self-Tracking Entities](xref:ef6/fundamentals/disconnected-entities/self-tracking-entities/index).</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="92ee6-124">Больше не рекомендуется использовать шаблон сущностей с самостоятельным отслеживанием.</span><span class="sxs-lookup"><span data-stu-id="92ee6-124">We no longer recommend using the self-tracking-entities template.</span></span> <span data-ttu-id="92ee6-125">Он по-прежнему будет доступен только для поддержки существующих приложений.</span><span class="sxs-lookup"><span data-stu-id="92ee6-125">It will only continue to be available to support existing applications.</span></span> <span data-ttu-id="92ee6-126">Если приложению необходимо работать с отключенными графами сущностей, рассмотрите другие варианты, такие как [отслеживаемые сущности](https://trackableentities.github.io/), которые технологически эквивалентны сущностям с самостоятельным отслеживанием, активно разрабатываемым сообществом. Или остановитесь на написании пользовательского кода с помощью API-интерфейсов отслеживания изменений низкого уровня.</span><span class="sxs-lookup"><span data-stu-id="92ee6-126">If your application requires working with disconnected graphs of entities, consider other alternatives such as [Trackable Entities](https://trackableentities.github.io/), which is a technology similar to Self-Tracking-Entities that is more actively developed by the community, or writing custom code using the low-level change tracking APIs.</span></span>
